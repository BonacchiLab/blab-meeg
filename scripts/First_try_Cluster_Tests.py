{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Connected to blab-meeg (Python 3.13.9)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9827d19e-35fe-4810-ad57-79d00e1e758d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#Import Room\n",
    "import mne\n",
    "import numpy as np\n",
    "import os\n",
    "import matplotlib \n",
    "matplotlib.use(\"Qt5Agg\")\n",
    "import matplotlib.pyplot as plt\n",
    "from pathlib import Path\n",
    "from mne.preprocessing import find_bad_channels_maxwell, maxwell_filter, ICA"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c546ca72-9f60-4364-a080-089a41199bfc",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Opening raw data file C:\\Users\\tomas\\Desktop\\a pasta das aulas\\Mestrado\\The Last Year aka Tese\\A pasta do codigo organizado\\Participantes\\Random peps\\CA112_MEEG_1\\scans\\DurR3_DurR3\\FIF\\CA112_MEEG_1_DurR3.fif...\n",
      "    Read a total of 8 projection items:\n",
      "        generated with autossp-1.2.0 (1 x 306)  idle\n",
      "        generated with autossp-1.2.0 (1 x 306)  idle\n",
      "        generated with autossp-1.2.0 (1 x 306)  idle\n",
      "        generated with autossp-1.2.0 (1 x 306)  idle\n",
      "        generated with autossp-1.2.0 (1 x 306)  idle\n",
      "        generated with autossp-1.2.0 (1 x 306)  idle\n",
      "        generated with autossp-1.2.0 (1 x 306)  idle\n",
      "        generated with autossp-1.2.0 (1 x 306)  idle\n",
      "    Range : 19000 ... 809999 =     19.000 ...   809.999 secs\n",
      "Ready.\n",
      "Reading 0 ... 790999  =      0.000 ...   790.999 secs...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-2-9d200ee3c2ca>:8: RuntimeWarning: This filename (C:\\Users\\tomas\\Desktop\\a pasta das aulas\\Mestrado\\The Last Year aka Tese\\A pasta do codigo organizado\\Participantes\\Random peps\\CA112_MEEG_1\\scans\\DurR3_DurR3\\FIF\\CA112_MEEG_1_DurR3.fif) does not conform to MNE naming conventions. All raw files should end with raw.fif, raw_sss.fif, raw_tsss.fif, _meg.fif, _eeg.fif, _ieeg.fif, raw.fif.gz, raw_sss.fif.gz, raw_tsss.fif.gz, _meg.fif.gz, _eeg.fif.gz or _ieeg.fif.gz\n",
      "  raw = mne.io.read_raw_fif(sample_data_raw_file, preload=True)\n"
     ]
    }
   ],
   "source": [
    "#Calling the file\n",
    "base_dir = r\"C:\\Users\\tomas\\Desktop\\a pasta das aulas\\Mestrado\\The Last Year aka Tese\\A pasta do codigo organizado\"\n",
    "#insert the file \n",
    "sample_data_raw_file = fr\"{base_dir}\\Participantes\\Random peps\\CA112_MEEG_1\\scans\\DurR3_DurR3\\FIF\\CA112_MEEG_1_DurR3.fif\"\n",
    "cal_file = fr\"{base_dir}\\Participantes\\Random peps\\CA112_MEEG_1\\resources\\METADATA\\calibration_crosstalk_coreg\\sub-CA112_ses-1_acq-calibration_meg.dat\"\n",
    "ct_file  = fr\"{base_dir}\\Participantes\\Random peps\\CA112_MEEG_1\\resources\\METADATA\\calibration_crosstalk_coreg\\sub-CA112_ses-1_acq-crosstalk_meg.fif\"\n",
    "raw = mne.io.read_raw_fif(sample_data_raw_file, preload=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c9fd136a-3572-4612-a5de-670e39f278c9",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Applying low-pass filter with 40.0 Hz cutoff frequency ...\n",
      "Filtering raw data in 1 contiguous segment\n",
      "Setting up low-pass filter at 40 Hz\n",
      "\n",
      "FIR filter parameters\n",
      "---------------------\n",
      "Designing a one-pass, zero-phase, non-causal lowpass filter:\n",
      "- Windowed time-domain design (firwin) method\n",
      "- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation\n",
      "- Upper passband edge: 40.00 Hz\n",
      "- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)\n",
      "- Filter length: 331 samples (0.331 s)\n",
      "\n",
      "Scanning for bad channels in 158 intervals (5.0 s) ...\n",
      "102 of 102 magnetometer types replaced with T3.\n",
      "    No bad MEG channels\n",
      "    Processing 204 gradiometers and 102 magnetometers\n",
      "    Using fine calibration sub-CA112_ses-1_acq-calibration_meg.dat\n",
      "        Adjusting non-orthogonal EX and EY\n",
      "        Adjusted coil orientations by (μ ± σ): 0.3° ± 0.3° (max: 1.6°)\n",
      "    Automatic origin fit: head of radius 96.7 mm\n",
      "    Using origin 1.1, 9.2, 60.0 mm in the head frame\n",
      "        Interval   1:    0.000 -    4.999\n",
      "        Interval   2:    5.000 -    9.999\n",
      "        Interval   3:   10.000 -   14.999\n",
      "        Interval   4:   15.000 -   19.999\n",
      "        Interval   5:   20.000 -   24.999\n",
      "        Interval   6:   25.000 -   29.999\n",
      "        Interval   7:   30.000 -   34.999\n",
      "        Interval   8:   35.000 -   39.999\n",
      "        Interval   9:   40.000 -   44.999\n",
      "        Interval  10:   45.000 -   49.999\n",
      "        Interval  11:   50.000 -   54.999\n",
      "        Interval  12:   55.000 -   59.999\n",
      "        Interval  13:   60.000 -   64.999\n",
      "        Interval  14:   65.000 -   69.999\n",
      "        Interval  15:   70.000 -   74.999\n",
      "        Interval  16:   75.000 -   79.999\n",
      "        Interval  17:   80.000 -   84.999\n",
      "        Interval  18:   85.000 -   89.999\n",
      "        Interval  19:   90.000 -   94.999\n",
      "        Interval  20:   95.000 -   99.999\n",
      "        Interval  21:  100.000 -  104.999\n",
      "        Interval  22:  105.000 -  109.999\n",
      "        Interval  23:  110.000 -  114.999\n",
      "        Interval  24:  115.000 -  119.999\n",
      "        Interval  25:  120.000 -  124.999\n",
      "        Interval  26:  125.000 -  129.999\n",
      "        Interval  27:  130.000 -  134.999\n",
      "        Interval  28:  135.000 -  139.999\n",
      "        Interval  29:  140.000 -  144.999\n",
      "        Interval  30:  145.000 -  149.999\n",
      "        Interval  31:  150.000 -  154.999\n",
      "        Interval  32:  155.000 -  159.999\n",
      "        Interval  33:  160.000 -  164.999\n",
      "        Interval  34:  165.000 -  169.999\n",
      "        Interval  35:  170.000 -  174.999\n",
      "        Interval  36:  175.000 -  179.999\n",
      "        Interval  37:  180.000 -  184.999\n",
      "        Interval  38:  185.000 -  189.999\n",
      "        Interval  39:  190.000 -  194.999\n",
      "        Interval  40:  195.000 -  199.999\n",
      "        Interval  41:  200.000 -  204.999\n",
      "        Interval  42:  205.000 -  209.999\n",
      "        Interval  43:  210.000 -  214.999\n",
      "        Interval  44:  215.000 -  219.999\n",
      "        Interval  45:  220.000 -  224.999\n",
      "        Interval  46:  225.000 -  229.999\n",
      "        Interval  47:  230.000 -  234.999\n",
      "        Interval  48:  235.000 -  239.999\n",
      "        Interval  49:  240.000 -  244.999\n",
      "        Interval  50:  245.000 -  249.999\n",
      "        Interval  51:  250.000 -  254.999\n",
      "        Interval  52:  255.000 -  259.999\n",
      "        Interval  53:  260.000 -  264.999\n",
      "        Interval  54:  265.000 -  269.999\n",
      "        Interval  55:  270.000 -  274.999\n",
      "        Interval  56:  275.000 -  279.999\n",
      "        Interval  57:  280.000 -  284.999\n",
      "        Interval  58:  285.000 -  289.999\n",
      "        Interval  59:  290.000 -  294.999\n",
      "        Interval  60:  295.000 -  299.999\n",
      "        Interval  61:  300.000 -  304.999\n",
      "        Interval  62:  305.000 -  309.999\n",
      "        Interval  63:  310.000 -  314.999\n",
      "        Interval  64:  315.000 -  319.999\n",
      "        Interval  65:  320.000 -  324.999\n",
      "        Interval  66:  325.000 -  329.999\n",
      "        Interval  67:  330.000 -  334.999\n",
      "        Interval  68:  335.000 -  339.999\n",
      "        Interval  69:  340.000 -  344.999\n",
      "        Interval  70:  345.000 -  349.999\n",
      "        Interval  71:  350.000 -  354.999\n",
      "        Interval  72:  355.000 -  359.999\n",
      "        Interval  73:  360.000 -  364.999\n",
      "        Interval  74:  365.000 -  369.999\n",
      "        Interval  75:  370.000 -  374.999\n",
      "        Interval  76:  375.000 -  379.999\n",
      "        Interval  77:  380.000 -  384.999\n",
      "        Interval  78:  385.000 -  389.999\n",
      "        Interval  79:  390.000 -  394.999\n",
      "        Interval  80:  395.000 -  399.999\n",
      "        Interval  81:  400.000 -  404.999\n",
      "        Interval  82:  405.000 -  409.999\n",
      "        Interval  83:  410.000 -  414.999\n",
      "        Interval  84:  415.000 -  419.999\n",
      "        Interval  85:  420.000 -  424.999\n",
      "        Interval  86:  425.000 -  429.999\n",
      "        Interval  87:  430.000 -  434.999\n",
      "        Interval  88:  435.000 -  439.999\n",
      "        Interval  89:  440.000 -  444.999\n",
      "        Interval  90:  445.000 -  449.999\n",
      "        Interval  91:  450.000 -  454.999\n",
      "        Interval  92:  455.000 -  459.999\n",
      "        Interval  93:  460.000 -  464.999\n",
      "        Interval  94:  465.000 -  469.999\n",
      "        Interval  95:  470.000 -  474.999\n",
      "        Interval  96:  475.000 -  479.999\n",
      "        Interval  97:  480.000 -  484.999\n",
      "        Interval  98:  485.000 -  489.999\n",
      "        Interval  99:  490.000 -  494.999\n",
      "        Interval 100:  495.000 -  499.999\n",
      "        Interval 101:  500.000 -  504.999\n",
      "        Interval 102:  505.000 -  509.999\n",
      "        Interval 103:  510.000 -  514.999\n",
      "        Interval 104:  515.000 -  519.999\n",
      "        Interval 105:  520.000 -  524.999\n",
      "        Interval 106:  525.000 -  529.999\n",
      "        Interval 107:  530.000 -  534.999\n",
      "        Interval 108:  535.000 -  539.999\n",
      "        Interval 109:  540.000 -  544.999\n",
      "        Interval 110:  545.000 -  549.999\n",
      "        Interval 111:  550.000 -  554.999\n",
      "        Interval 112:  555.000 -  559.999\n",
      "        Interval 113:  560.000 -  564.999\n",
      "        Interval 114:  565.000 -  569.999\n",
      "        Interval 115:  570.000 -  574.999\n",
      "        Interval 116:  575.000 -  579.999\n",
      "        Interval 117:  580.000 -  584.999\n",
      "        Interval 118:  585.000 -  589.999\n",
      "        Interval 119:  590.000 -  594.999\n",
      "        Interval 120:  595.000 -  599.999\n",
      "        Interval 121:  600.000 -  604.999\n",
      "        Interval 122:  605.000 -  609.999\n",
      "        Interval 123:  610.000 -  614.999\n",
      "        Interval 124:  615.000 -  619.999\n",
      "        Interval 125:  620.000 -  624.999\n",
      "        Interval 126:  625.000 -  629.999\n",
      "        Interval 127:  630.000 -  634.999\n",
      "        Interval 128:  635.000 -  639.999\n",
      "        Interval 129:  640.000 -  644.999\n",
      "        Interval 130:  645.000 -  649.999\n",
      "        Interval 131:  650.000 -  654.999\n",
      "        Interval 132:  655.000 -  659.999\n",
      "        Interval 133:  660.000 -  664.999\n",
      "        Interval 134:  665.000 -  669.999\n",
      "        Interval 135:  670.000 -  674.999\n",
      "        Interval 136:  675.000 -  679.999\n",
      "        Interval 137:  680.000 -  684.999\n",
      "        Interval 138:  685.000 -  689.999\n",
      "        Interval 139:  690.000 -  694.999\n",
      "        Interval 140:  695.000 -  699.999\n",
      "        Interval 141:  700.000 -  704.999\n",
      "        Interval 142:  705.000 -  709.999\n",
      "        Interval 143:  710.000 -  714.999\n",
      "        Interval 144:  715.000 -  719.999\n",
      "        Interval 145:  720.000 -  724.999\n",
      "        Interval 146:  725.000 -  729.999\n",
      "        Interval 147:  730.000 -  734.999\n",
      "        Interval 148:  735.000 -  739.999\n",
      "        Interval 149:  740.000 -  744.999\n",
      "        Interval 150:  745.000 -  749.999\n",
      "        Interval 151:  750.000 -  754.999\n",
      "        Interval 152:  755.000 -  759.999\n",
      "        Interval 153:  760.000 -  764.999\n",
      "        Interval 154:  765.000 -  769.999\n",
      "        Interval 155:  770.000 -  774.999\n",
      "        Interval 156:  775.000 -  779.999\n",
      "        Interval 157:  780.000 -  784.999\n",
      "        Interval 158:  785.000 -  790.999\n",
      "    Static bad channels:  ['MEG2433']\n",
      "    Static flat channels: []\n",
      "[done]\n",
      "Noisy channels: ['MEG2433']\n",
      "Flat channels : []\n",
      "Bads ANTES do SSS: ['MEG2433', 'MEG0131']\n",
      "102 of 102 magnetometer types replaced with T3.\n",
      "Maxwell filtering raw data\n",
      "    Bad MEG channels being reconstructed: ['MEG2433', 'MEG0131']\n",
      "    Processing 204 gradiometers and 102 magnetometers\n",
      "    Using fine calibration sub-CA112_ses-1_acq-calibration_meg.dat\n",
      "        Adjusting non-orthogonal EX and EY\n",
      "        Adjusted coil orientations by (μ ± σ): 0.3° ± 0.3° (max: 1.6°)\n",
      "    Automatic origin fit: head of radius 96.7 mm\n",
      "    Using origin 1.1, 9.2, 60.0 mm in the head frame\n",
      "    Using loaded raw data\n",
      "        Using 83/95 harmonic components for    0.000  (68/80 in, 15/15 out)\n",
      "    Processing   79 data chunks of (at least) 10.0 s with 0.0 s overlap and boxcar windowing\n",
      "    The final 1.0 s will be lumped into the final window\n",
      "        Using 83/95 harmonic components for    0.000  (68/80 in, 15/15 out)\n",
      "[done]\n",
      "Bads DEPOIS do SSS: ['MEG2433', 'MEG0131']\n"
     ]
    }
   ],
   "source": [
    "#Detetar bad channels automaticamente (MEG)\n",
    "raw.info['bads'] = []  # começa sem nada marcado\n",
    "auto_noisy, auto_flat, auto_scores = find_bad_channels_maxwell(\n",
    "    raw.copy(),\n",
    "    calibration=cal_file,\n",
    "    cross_talk=ct_file,\n",
    "    return_scores=True,\n",
    "    verbose=True,\n",
    ")\n",
    "print(\"Noisy channels:\", auto_noisy)\n",
    "print(\"Flat channels :\", auto_flat)\n",
    "raw.info['bads'].extend(auto_noisy + auto_flat)\n",
    "raw.info['bads'].append('MEG0131')\n",
    "#raw.info['bads'].append('MEGXXXX')  #para meter mais se quiser\n",
    "\n",
    "#So para chekar é lixo depois \n",
    "print(\"Bads ANTES do SSS:\", raw.info['bads'])\n",
    "# guardar lista para reaplicar depois\n",
    "bads_for_sss = raw.info['bads'].copy()\n",
    "\n",
    "\n",
    "# 4) Corrigir tipos de bobina dos magnetómetros (obrigatório em Elekta)\n",
    "raw.fix_mag_coil_types()\n",
    "\n",
    "# Maxwell filter – SSS (sem tSSS, igual ao Cogitate)\n",
    "raw_sss = maxwell_filter(\n",
    "    raw,\n",
    "    calibration=cal_file,\n",
    "    cross_talk=ct_file,\n",
    "    st_duration=None,      # SSS simples  --- desligar pra fazer tSSS\n",
    "    #st_duration=10.0,      # tSSS com janela de 10 s --- se quiseres ativar tSSS liga estes 2 \n",
    "    #st_correlation=0.98,   # default razoável\n",
    "    origin='auto',\n",
    "    coord_frame='head',\n",
    "    verbose=True,\n",
    ")\n",
    "# re-meter a lista de bads no Raw filtrado\n",
    "raw_sss.info['bads'] = bads_for_sss\n",
    "print(\"Bads DEPOIS do SSS:\", raw_sss.info['bads'])\n",
    "raw = raw_sss"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5c9f815c-bef4-4432-8ec7-4898ef9d5621",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Filtering raw data in 1 contiguous segment\n",
      "Setting up band-stop filter\n",
      "\n",
      "FIR filter parameters\n",
      "---------------------\n",
      "Designing a one-pass, zero-phase, non-causal bandstop filter:\n",
      "- Windowed time-domain design (firwin) method\n",
      "- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation\n",
      "- Lower transition bandwidth: 0.50 Hz\n",
      "- Upper transition bandwidth: 0.50 Hz\n",
      "- Filter length: 6601 samples (6.601 s)\n",
      "\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<script type=\"text/javascript\">\n",
       "    // must be `var` (not `const`) because this can get embedded multiple times on a page\n",
       "var toggleVisibility = (className) => {\n",
       "\n",
       "    const elements = document.querySelectorAll(`.${className}`);\n",
       "\n",
       "    elements.forEach(element => {\n",
       "        if (element.classList.contains(\"mne-repr-section-header\")) {\n",
       "            return  // Don't collapse the section header row\n",
       "        }\n",
       "        element.classList.toggle(\"mne-repr-collapsed\");\n",
       "    });\n",
       "\n",
       "    // trigger caret to rotate\n",
       "    var sel = `.mne-repr-section-header.${className} > th.mne-repr-section-toggle > button`;\n",
       "    const button = document.querySelector(sel);\n",
       "    button.classList.toggle(\"collapsed\");\n",
       "\n",
       "    // adjust tooltip\n",
       "    sel = `tr.mne-repr-section-header.${className}`;\n",
       "    const secHeadRow = document.querySelector(sel);\n",
       "    secHeadRow.classList.toggle(\"collapsed\");\n",
       "    secHeadRow.title = secHeadRow.title === \"Hide section\" ? \"Show section\" : \"Hide section\";\n",
       "}\n",
       "</script>\n",
       "\n",
       "<style type=\"text/css\">\n",
       "    /*\n",
       "Styles in this section apply both to the sphinx-built website docs and to notebooks\n",
       "rendered in an IDE or in Jupyter. In our web docs, styles here are complemented by\n",
       "doc/_static/styles.css and other CSS files (e.g. from the sphinx theme, sphinx-gallery,\n",
       "or bootstrap). In IDEs/Jupyter, those style files are unavailable, so only the rules in\n",
       "this file apply (plus whatever default styling the IDE applies).\n",
       "*/\n",
       ".mne-repr-table {\n",
       "    display: inline;  /* prevent using full container width */\n",
       "}\n",
       ".mne-repr-table tr.mne-repr-section-header > th {\n",
       "    padding-top: 1rem;\n",
       "    text-align: left;\n",
       "    vertical-align: middle;\n",
       "}\n",
       ".mne-repr-section-toggle > button {\n",
       "    all: unset;\n",
       "    display: block;\n",
       "    height: 1rem;\n",
       "    width: 1rem;\n",
       "}\n",
       ".mne-repr-section-toggle > button > svg {\n",
       "    height: 60%;\n",
       "}\n",
       "\n",
       "/* transition (rotation) effects on the collapser button */\n",
       ".mne-repr-section-toggle > button.collapsed > svg {\n",
       "    transition: 0.1s ease-out;\n",
       "    transform: rotate(-90deg);\n",
       "}\n",
       ".mne-repr-section-toggle > button:not(.collapsed) > svg {\n",
       "    transition: 0.1s ease-out;\n",
       "    transform: rotate(0deg);\n",
       "}\n",
       "\n",
       "/* hide collapsed table rows */\n",
       ".mne-repr-collapsed {\n",
       "    display: none;\n",
       "}\n",
       "\n",
       "\n",
       "@layer {\n",
       "    /*\n",
       "    Selectors in a `@layer` will always be lower-precedence than selectors outside the\n",
       "    layer. So even though e.g. `div.output_html` is present in the sphinx-rendered\n",
       "    website docs, the styles here won't take effect there as long as some other rule\n",
       "    somewhere in the page's CSS targets the same element.\n",
       "\n",
       "    In IDEs or Jupyter notebooks, though, the CSS files from the sphinx theme,\n",
       "    sphinx-gallery, and bootstrap are unavailable, so these styles will apply.\n",
       "\n",
       "    Notes:\n",
       "\n",
       "    - the selector `.accordion-body` is for MNE Reports\n",
       "    - the selector `.output_html` is for VSCode's notebook interface\n",
       "    - the selector `.jp-RenderedHTML` is for Jupyter notebook\n",
       "    - variables starting with `--theme-` are VSCode-specific.\n",
       "    - variables starting with `--jp-` are Jupyter styles, *some of which* are also\n",
       "      available in VSCode. Here we try the `--theme-` variable first, then fall back to\n",
       "      the `--jp-` ones.\n",
       "    */\n",
       "    .mne-repr-table {\n",
       "        --mne-toggle-color: var(--theme-foreground, var(--jp-ui-font-color1));\n",
       "        --mne-button-bg-color: var(--theme-button-background, var(--jp-info-color0, var(--jp-content-link-color)));\n",
       "        --mne-button-fg-color: var(--theme-button-foreground, var(--jp-ui-inverse-font-color0, var(--jp-editor-background)));\n",
       "        --mne-button-hover-bg-color: var(--theme-button-hover-background, var(--jp-info-color1));\n",
       "        --mne-button-radius: var(--jp-border-radius, 0.25rem);\n",
       "    }\n",
       "    /* chevron position/alignment; in VSCode it looks ok without adjusting */\n",
       "    .accordion-body .mne-repr-section-toggle > button,\n",
       "    .jp-RenderedHTML .mne-repr-section-toggle > button {\n",
       "        padding: 0 0 45% 25% !important;\n",
       "    }\n",
       "    /* chevron color; MNE Report doesn't have light/dark mode */\n",
       "    div.output_html .mne-repr-section-toggle > button > svg > path,\n",
       "    .jp-RenderedHTML .mne-repr-section-toggle > button > svg > path {\n",
       "        fill: var(--mne-toggle-color);\n",
       "    }\n",
       "    .accordion-body .mne-ch-names-btn,\n",
       "    div.output_html .mne-ch-names-btn,\n",
       "    .jp-RenderedHTML .mne-ch-names-btn {\n",
       "        -webkit-border-radius: var(--mne-button-radius);\n",
       "        -moz-border-radius: var(--mne-button-radius);\n",
       "        border-radius: var(--mne-button-radius);\n",
       "        border: none;\n",
       "        background-image: none;\n",
       "        background-color: var(--mne-button-bg-color);\n",
       "        color: var(--mne-button-fg-color);\n",
       "        font-size: inherit;\n",
       "        min-width: 1.5rem;\n",
       "        padding: 0.25rem;\n",
       "        text-align: center;\n",
       "        text-decoration: none;\n",
       "    }\n",
       "    .accordion-body .mne-ch-names-btn:hover,\n",
       "    div.output_html .mne.ch-names-btn:hover,\n",
       "    .jp-RenderedHTML .mne-ch-names-btn:hover {\n",
       "        background-color: var(--mne-button-hover-bg-color);\n",
       "        text-decoration: underline;\n",
       "    }\n",
       "    .accordion-body .mne-ch-names-btn:focus-visible,\n",
       "    div.output_html .mne-ch-names-btn:focus-visible,\n",
       "    .jp-RenderedHTML .mne-ch-names-btn:focus-visible {\n",
       "        outline: 0.1875rem solid var(--mne-button-bg-color) !important;\n",
       "        outline-offset: 0.1875rem !important;\n",
       "    }\n",
       "}\n",
       "</style>\n",
       "\n",
       "\n",
       "\n",
       "<table class=\"table mne-repr-table\">\n",
       "    \n",
       "\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "<tr class=\"mne-repr-section-header general-8e3e5d9e-295b-4159-b0ed-de944897745f\"\n",
       "     title=\"Hide section\" \n",
       "    onclick=\"toggleVisibility('general-8e3e5d9e-295b-4159-b0ed-de944897745f')\">\n",
       "    <th class=\"mne-repr-section-toggle\">\n",
       "        <button >\n",
       "            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d=\"M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z\"/></svg>\n",
       "        </button>\n",
       "    </th>\n",
       "    <th colspan=\"2\">\n",
       "        <strong>General</strong>\n",
       "    </th>\n",
       "</tr>\n",
       "\n",
       "\n",
       "<tr class=\"repr-element general-8e3e5d9e-295b-4159-b0ed-de944897745f \">\n",
       "    <td class=\"mne-repr-section-toggle\"></td>\n",
       "    <td>Filename(s)</td>\n",
       "    <td>\n",
       "        \n",
       "        CA112_MEEG_1_DurR3.fif\n",
       "        \n",
       "        \n",
       "    </td>\n",
       "</tr>\n",
       "\n",
       "<tr class=\"repr-element general-8e3e5d9e-295b-4159-b0ed-de944897745f \">\n",
       "    <td class=\"mne-repr-section-toggle\"></td>\n",
       "    <td>MNE object type</td>\n",
       "    <td>Raw</td>\n",
       "</tr>\n",
       "<tr class=\"repr-element general-8e3e5d9e-295b-4159-b0ed-de944897745f \">\n",
       "    <td class=\"mne-repr-section-toggle\"></td>\n",
       "    <td>Measurement date</td>\n",
       "    \n",
       "    <td>2000-01-01 at 00:00:00 UTC</td>\n",
       "    \n",
       "</tr>\n",
       "<tr class=\"repr-element general-8e3e5d9e-295b-4159-b0ed-de944897745f \">\n",
       "    <td class=\"mne-repr-section-toggle\"></td>\n",
       "    <td>Participant</td>\n",
       "    \n",
       "    \n",
       "    \n",
       "</tr>\n",
       "<tr class=\"repr-element general-8e3e5d9e-295b-4159-b0ed-de944897745f \">\n",
       "    <td class=\"mne-repr-section-toggle\"></td>\n",
       "    <td>Experimenter</td>\n",
       "    \n",
       "    <td>mne_anonymize</td>\n",
       "    \n",
       "</tr>\n",
       "    \n",
       "\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "<tr class=\"mne-repr-section-header acquisition-a4fc2c57-19af-4de0-a700-9e954f6d2449\"\n",
       "     title=\"Hide section\" \n",
       "    onclick=\"toggleVisibility('acquisition-a4fc2c57-19af-4de0-a700-9e954f6d2449')\">\n",
       "    <th class=\"mne-repr-section-toggle\">\n",
       "        <button >\n",
       "            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d=\"M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z\"/></svg>\n",
       "        </button>\n",
       "    </th>\n",
       "    <th colspan=\"2\">\n",
       "        <strong>Acquisition</strong>\n",
       "    </th>\n",
       "</tr>\n",
       "\n",
       "\n",
       "<tr class=\"repr-element acquisition-a4fc2c57-19af-4de0-a700-9e954f6d2449 \">\n",
       "    <td class=\"mne-repr-section-toggle\"></td>\n",
       "    <td>Duration</td>\n",
       "    <td>00:13:11 (HH:MM:SS)</td>\n",
       "</tr>\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "<tr class=\"repr-element acquisition-a4fc2c57-19af-4de0-a700-9e954f6d2449 \">\n",
       "    <td class=\"mne-repr-section-toggle\"></td>\n",
       "    <td>Sampling frequency</td>\n",
       "    <td>1000.00 Hz</td>\n",
       "</tr>\n",
       "\n",
       "\n",
       "<tr class=\"repr-element acquisition-a4fc2c57-19af-4de0-a700-9e954f6d2449 \">\n",
       "    <td class=\"mne-repr-section-toggle\"></td>\n",
       "    <td>Time points</td>\n",
       "    <td>791,000</td>\n",
       "</tr>\n",
       "\n",
       "\n",
       "    \n",
       "\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "<tr class=\"mne-repr-section-header channels-1270da44-edd8-440e-9b7b-0a86dd2740e8\"\n",
       "     title=\"Hide section\" \n",
       "    onclick=\"toggleVisibility('channels-1270da44-edd8-440e-9b7b-0a86dd2740e8')\">\n",
       "    <th class=\"mne-repr-section-toggle\">\n",
       "        <button >\n",
       "            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d=\"M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z\"/></svg>\n",
       "        </button>\n",
       "    </th>\n",
       "    <th colspan=\"2\">\n",
       "        <strong>Channels</strong>\n",
       "    </th>\n",
       "</tr>\n",
       "\n",
       "\n",
       "    \n",
       "<tr class=\"repr-element channels-1270da44-edd8-440e-9b7b-0a86dd2740e8 \">\n",
       "    <td class=\"mne-repr-section-toggle\"></td>\n",
       "    <td>Magnetometers</td>\n",
       "    <td>\n",
       "        <button class=\"mne-ch-names-btn sd-sphinx-override sd-btn sd-btn-info sd-text-wrap sd-shadow-sm\" onclick=\"alert('Good Magnetometers:\\n\\nMEG0111, MEG0121, MEG0141, MEG0211, MEG0221, MEG0231, MEG0241, MEG0311, MEG0321, MEG0331, MEG0341, MEG0411, MEG0421, MEG0431, MEG0441, MEG0511, MEG0521, MEG0531, MEG0541, MEG0611, MEG0621, MEG0631, MEG0641, MEG0711, MEG0721, MEG0731, MEG0741, MEG0811, MEG0821, MEG0911, MEG0921, MEG0931, MEG0941, MEG1011, MEG1021, MEG1031, MEG1041, MEG1111, MEG1121, MEG1131, MEG1141, MEG1211, MEG1221, MEG1231, MEG1241, MEG1311, MEG1321, MEG1331, MEG1341, MEG1411, MEG1421, MEG1431, MEG1441, MEG1511, MEG1521, MEG1531, MEG1541, MEG1611, MEG1621, MEG1631, MEG1641, MEG1711, MEG1721, MEG1731, MEG1741, MEG1811, MEG1821, MEG1831, MEG1841, MEG1911, MEG1921, MEG1931, MEG1941, MEG2011, MEG2021, MEG2031, MEG2041, MEG2111, MEG2121, MEG2131, MEG2141, MEG2211, MEG2221, MEG2231, MEG2241, MEG2311, MEG2321, MEG2331, MEG2341, MEG2411, MEG2421, MEG2431, MEG2441, MEG2511, MEG2521, MEG2531, MEG2541, MEG2611, MEG2621, MEG2631, MEG2641')\" title=\"(Click to open in popup)&#13;&#13;MEG0111, MEG0121, MEG0141, MEG0211, MEG0221, MEG0231, MEG0241, MEG0311, MEG0321, MEG0331, MEG0341, MEG0411, MEG0421, MEG0431, MEG0441, MEG0511, MEG0521, MEG0531, MEG0541, MEG0611, MEG0621, MEG0631, MEG0641, MEG0711, MEG0721, MEG0731, MEG0741, MEG0811, MEG0821, MEG0911, MEG0921, MEG0931, MEG0941, MEG1011, MEG1021, MEG1031, MEG1041, MEG1111, MEG1121, MEG1131, MEG1141, MEG1211, MEG1221, MEG1231, MEG1241, MEG1311, MEG1321, MEG1331, MEG1341, MEG1411, MEG1421, MEG1431, MEG1441, MEG1511, MEG1521, MEG1531, MEG1541, MEG1611, MEG1621, MEG1631, MEG1641, MEG1711, MEG1721, MEG1731, MEG1741, MEG1811, MEG1821, MEG1831, MEG1841, MEG1911, MEG1921, MEG1931, MEG1941, MEG2011, MEG2021, MEG2031, MEG2041, MEG2111, MEG2121, MEG2131, MEG2141, MEG2211, MEG2221, MEG2231, MEG2241, MEG2311, MEG2321, MEG2331, MEG2341, MEG2411, MEG2421, MEG2431, MEG2441, MEG2511, MEG2521, MEG2531, MEG2541, MEG2611, MEG2621, MEG2631, MEG2641\">\n",
       "            101\n",
       "        </button>\n",
       "\n",
       "        \n",
       "        \n",
       "        and <button class=\"mne-ch-names-btn sd-sphinx-override sd-btn sd-btn-info sd-text-wrap sd-shadow-sm\" onclick=\"alert('Bad Magnetometers:\\n\\nMEG0131')\" title=\"(Click to open in popup)&#13;&#13;MEG0131\">\n",
       "            1 bad\n",
       "        </button>\n",
       "        \n",
       "    </td>\n",
       "</tr>\n",
       "\n",
       "    \n",
       "<tr class=\"repr-element channels-1270da44-edd8-440e-9b7b-0a86dd2740e8 \">\n",
       "    <td class=\"mne-repr-section-toggle\"></td>\n",
       "    <td>Gradiometers</td>\n",
       "    <td>\n",
       "        <button class=\"mne-ch-names-btn sd-sphinx-override sd-btn sd-btn-info sd-text-wrap sd-shadow-sm\" onclick=\"alert('Good Gradiometers:\\n\\nMEG0112, MEG0113, MEG0122, MEG0123, MEG0132, MEG0133, MEG0142, MEG0143, MEG0212, MEG0213, MEG0222, MEG0223, MEG0232, MEG0233, MEG0242, MEG0243, MEG0312, MEG0313, MEG0322, MEG0323, MEG0332, MEG0333, MEG0342, MEG0343, MEG0412, MEG0413, MEG0422, MEG0423, MEG0432, MEG0433, MEG0442, MEG0443, MEG0512, MEG0513, MEG0522, MEG0523, MEG0532, MEG0533, MEG0542, MEG0543, MEG0612, MEG0613, MEG0622, MEG0623, MEG0632, MEG0633, MEG0642, MEG0643, MEG0712, MEG0713, MEG0722, MEG0723, MEG0732, MEG0733, MEG0742, MEG0743, MEG0812, MEG0813, MEG0822, MEG0823, MEG0912, MEG0913, MEG0922, MEG0923, MEG0932, MEG0933, MEG0942, MEG0943, MEG1012, MEG1013, MEG1022, MEG1023, MEG1032, MEG1033, MEG1042, MEG1043, MEG1112, MEG1113, MEG1122, MEG1123, MEG1132, MEG1133, MEG1142, MEG1143, MEG1212, MEG1213, MEG1222, MEG1223, MEG1232, MEG1233, MEG1242, MEG1243, MEG1312, MEG1313, MEG1322, MEG1323, MEG1332, MEG1333, MEG1342, MEG1343, MEG1412, MEG1413, MEG1422, MEG1423, MEG1432, MEG1433, MEG1442, MEG1443, MEG1512, MEG1513, MEG1522, MEG1523, MEG1532, MEG1533, MEG1542, MEG1543, MEG1612, MEG1613, MEG1622, MEG1623, MEG1632, MEG1633, MEG1642, MEG1643, MEG1712, MEG1713, MEG1722, MEG1723, MEG1732, MEG1733, MEG1742, MEG1743, MEG1812, MEG1813, MEG1822, MEG1823, MEG1832, MEG1833, MEG1842, MEG1843, MEG1912, MEG1913, MEG1922, MEG1923, MEG1932, MEG1933, MEG1942, MEG1943, MEG2012, MEG2013, MEG2022, MEG2023, MEG2032, MEG2033, MEG2042, MEG2043, MEG2112, MEG2113, MEG2122, MEG2123, MEG2132, MEG2133, MEG2142, MEG2143, MEG2212, MEG2213, MEG2222, MEG2223, MEG2232, MEG2233, MEG2242, MEG2243, MEG2312, MEG2313, MEG2322, MEG2323, MEG2332, MEG2333, MEG2342, MEG2343, MEG2412, MEG2413, MEG2422, MEG2423, MEG2432, MEG2442, MEG2443, MEG2512, MEG2513, MEG2522, MEG2523, MEG2532, MEG2533, MEG2542, MEG2543, MEG2612, MEG2613, MEG2622, MEG2623, MEG2632, MEG2633, MEG2642, MEG2643')\" title=\"(Click to open in popup)&#13;&#13;MEG0112, MEG0113, MEG0122, MEG0123, MEG0132, MEG0133, MEG0142, MEG0143, MEG0212, MEG0213, MEG0222, MEG0223, MEG0232, MEG0233, MEG0242, MEG0243, MEG0312, MEG0313, MEG0322, MEG0323, MEG0332, MEG0333, MEG0342, MEG0343, MEG0412, MEG0413, MEG0422, MEG0423, MEG0432, MEG0433, MEG0442, MEG0443, MEG0512, MEG0513, MEG0522, MEG0523, MEG0532, MEG0533, MEG0542, MEG0543, MEG0612, MEG0613, MEG0622, MEG0623, MEG0632, MEG0633, MEG0642, MEG0643, MEG0712, MEG0713, MEG0722, MEG0723, MEG0732, MEG0733, MEG0742, MEG0743, MEG0812, MEG0813, MEG0822, MEG0823, MEG0912, MEG0913, MEG0922, MEG0923, MEG0932, MEG0933, MEG0942, MEG0943, MEG1012, MEG1013, MEG1022, MEG1023, MEG1032, MEG1033, MEG1042, MEG1043, MEG1112, MEG1113, MEG1122, MEG1123, MEG1132, MEG1133, MEG1142, MEG1143, MEG1212, MEG1213, MEG1222, MEG1223, MEG1232, MEG1233, MEG1242, MEG1243, MEG1312, MEG1313, MEG1322, MEG1323, MEG1332, MEG1333, MEG1342, MEG1343, MEG1412, MEG1413, MEG1422, MEG1423, MEG1432, MEG1433, MEG1442, MEG1443, MEG1512, MEG1513, MEG1522, MEG1523, MEG1532, MEG1533, MEG1542, MEG1543, MEG1612, MEG1613, MEG1622, MEG1623, MEG1632, MEG1633, MEG1642, MEG1643, MEG1712, MEG1713, MEG1722, MEG1723, MEG1732, MEG1733, MEG1742, MEG1743, MEG1812, MEG1813, MEG1822, MEG1823, MEG1832, MEG1833, MEG1842, MEG1843, MEG1912, MEG1913, MEG1922, MEG1923, MEG1932, MEG1933, MEG1942, MEG1943, MEG2012, MEG2013, MEG2022, MEG2023, MEG2032, MEG2033, MEG2042, MEG2043, MEG2112, MEG2113, MEG2122, MEG2123, MEG2132, MEG2133, MEG2142, MEG2143, MEG2212, MEG2213, MEG2222, MEG2223, MEG2232, MEG2233, MEG2242, MEG2243, MEG2312, MEG2313, MEG2322, MEG2323, MEG2332, MEG2333, MEG2342, MEG2343, MEG2412, MEG2413, MEG2422, MEG2423, MEG2432, MEG2442, MEG2443, MEG2512, MEG2513, MEG2522, MEG2523, MEG2532, MEG2533, MEG2542, MEG2543, MEG2612, MEG2613, MEG2622, MEG2623, MEG2632, MEG2633, MEG2642, MEG2643\">\n",
       "            203\n",
       "        </button>\n",
       "\n",
       "        \n",
       "        \n",
       "        and <button class=\"mne-ch-names-btn sd-sphinx-override sd-btn sd-btn-info sd-text-wrap sd-shadow-sm\" onclick=\"alert('Bad Gradiometers:\\n\\nMEG2433')\" title=\"(Click to open in popup)&#13;&#13;MEG2433\">\n",
       "            1 bad\n",
       "        </button>\n",
       "        \n",
       "    </td>\n",
       "</tr>\n",
       "\n",
       "    \n",
       "<tr class=\"repr-element channels-1270da44-edd8-440e-9b7b-0a86dd2740e8 \">\n",
       "    <td class=\"mne-repr-section-toggle\"></td>\n",
       "    <td>EEG</td>\n",
       "    <td>\n",
       "        <button class=\"mne-ch-names-btn sd-sphinx-override sd-btn sd-btn-info sd-text-wrap sd-shadow-sm\" onclick=\"alert('Good EEG:\\n\\nEEG001, EEG002, EEG003, EEG004, EEG005, EEG006, EEG007, EEG008, EEG009, EEG010, EEG011, EEG012, EEG013, EEG014, EEG015, EEG016, EEG017, EEG018, EEG019, EEG020, EEG021, EEG022, EEG023, EEG024, EEG025, EEG026, EEG027, EEG028, EEG029, EEG030, EEG031, EEG032, EEG033, EEG034, EEG035, EEG036, EEG037, EEG038, EEG039, EEG040, EEG041, EEG042, EEG043, EEG044, EEG045, EEG046, EEG047, EEG048, EEG049, EEG050, EEG051, EEG052, EEG053, EEG054, EEG055, EEG056, EEG057, EEG058, EEG059, EEG060, EEG061, EEG062, EEG063, EEG064')\" title=\"(Click to open in popup)&#13;&#13;EEG001, EEG002, EEG003, EEG004, EEG005, EEG006, EEG007, EEG008, EEG009, EEG010, EEG011, EEG012, EEG013, EEG014, EEG015, EEG016, EEG017, EEG018, EEG019, EEG020, EEG021, EEG022, EEG023, EEG024, EEG025, EEG026, EEG027, EEG028, EEG029, EEG030, EEG031, EEG032, EEG033, EEG034, EEG035, EEG036, EEG037, EEG038, EEG039, EEG040, EEG041, EEG042, EEG043, EEG044, EEG045, EEG046, EEG047, EEG048, EEG049, EEG050, EEG051, EEG052, EEG053, EEG054, EEG055, EEG056, EEG057, EEG058, EEG059, EEG060, EEG061, EEG062, EEG063, EEG064\">\n",
       "            64\n",
       "        </button>\n",
       "\n",
       "        \n",
       "    </td>\n",
       "</tr>\n",
       "\n",
       "    \n",
       "<tr class=\"repr-element channels-1270da44-edd8-440e-9b7b-0a86dd2740e8 \">\n",
       "    <td class=\"mne-repr-section-toggle\"></td>\n",
       "    <td>EOG</td>\n",
       "    <td>\n",
       "        <button class=\"mne-ch-names-btn sd-sphinx-override sd-btn sd-btn-info sd-text-wrap sd-shadow-sm\" onclick=\"alert('Good EOG:\\n\\nEOG001, EOG002')\" title=\"(Click to open in popup)&#13;&#13;EOG001, EOG002\">\n",
       "            2\n",
       "        </button>\n",
       "\n",
       "        \n",
       "    </td>\n",
       "</tr>\n",
       "\n",
       "    \n",
       "<tr class=\"repr-element channels-1270da44-edd8-440e-9b7b-0a86dd2740e8 \">\n",
       "    <td class=\"mne-repr-section-toggle\"></td>\n",
       "    <td>ECG</td>\n",
       "    <td>\n",
       "        <button class=\"mne-ch-names-btn sd-sphinx-override sd-btn sd-btn-info sd-text-wrap sd-shadow-sm\" onclick=\"alert('Good ECG:\\n\\nECG003')\" title=\"(Click to open in popup)&#13;&#13;ECG003\">\n",
       "            1\n",
       "        </button>\n",
       "\n",
       "        \n",
       "    </td>\n",
       "</tr>\n",
       "\n",
       "    \n",
       "<tr class=\"repr-element channels-1270da44-edd8-440e-9b7b-0a86dd2740e8 \">\n",
       "    <td class=\"mne-repr-section-toggle\"></td>\n",
       "    <td>misc</td>\n",
       "    <td>\n",
       "        <button class=\"mne-ch-names-btn sd-sphinx-override sd-btn sd-btn-info sd-text-wrap sd-shadow-sm\" onclick=\"alert('Good misc:\\n\\nMISC001, MISC002, MISC003, MISC004, MISC005')\" title=\"(Click to open in popup)&#13;&#13;MISC001, MISC002, MISC003, MISC004, MISC005\">\n",
       "            5\n",
       "        </button>\n",
       "\n",
       "        \n",
       "    </td>\n",
       "</tr>\n",
       "\n",
       "    \n",
       "<tr class=\"repr-element channels-1270da44-edd8-440e-9b7b-0a86dd2740e8 \">\n",
       "    <td class=\"mne-repr-section-toggle\"></td>\n",
       "    <td>Stimulus</td>\n",
       "    <td>\n",
       "        <button class=\"mne-ch-names-btn sd-sphinx-override sd-btn sd-btn-info sd-text-wrap sd-shadow-sm\" onclick=\"alert('Good Stimulus:\\n\\nSTI001, STI002, STI003, STI004, STI005, STI006, STI007, STI008, STI009, STI010, STI011, STI012, STI013, STI016, STI101')\" title=\"(Click to open in popup)&#13;&#13;STI001, STI002, STI003, STI004, STI005, STI006, STI007, STI008, STI009, STI010, STI011, STI012, STI013, STI016, STI101\">\n",
       "            15\n",
       "        </button>\n",
       "\n",
       "        \n",
       "    </td>\n",
       "</tr>\n",
       "\n",
       "    \n",
       "<tr class=\"repr-element channels-1270da44-edd8-440e-9b7b-0a86dd2740e8 \">\n",
       "    <td class=\"mne-repr-section-toggle\"></td>\n",
       "    <td>Internal Active Shielding data (Triux systems)</td>\n",
       "    <td>\n",
       "        <button class=\"mne-ch-names-btn sd-sphinx-override sd-btn sd-btn-info sd-text-wrap sd-shadow-sm\" onclick=\"alert('Good Internal Active Shielding data (Triux systems):\\n\\nIASX+, IASX-, IASY+, IASY-, IASZ+, IASZ-, IAS_DX, IAS_DY, IAS_X, IAS_Y, IAS_Z')\" title=\"(Click to open in popup)&#13;&#13;IASX+, IASX-, IASY+, IASY-, IASZ+, IASZ-, IAS_DX, IAS_DY, IAS_X, IAS_Y, IAS_Z\">\n",
       "            11\n",
       "        </button>\n",
       "\n",
       "        \n",
       "    </td>\n",
       "</tr>\n",
       "\n",
       "    \n",
       "<tr class=\"repr-element channels-1270da44-edd8-440e-9b7b-0a86dd2740e8 \">\n",
       "    <td class=\"mne-repr-section-toggle\"></td>\n",
       "    <td>System status channel information (Triux systems)</td>\n",
       "    <td>\n",
       "        <button class=\"mne-ch-names-btn sd-sphinx-override sd-btn sd-btn-info sd-text-wrap sd-shadow-sm\" onclick=\"alert('Good System status channel information (Triux systems):\\n\\nSYS201')\" title=\"(Click to open in popup)&#13;&#13;SYS201\">\n",
       "            1\n",
       "        </button>\n",
       "\n",
       "        \n",
       "    </td>\n",
       "</tr>\n",
       "\n",
       "\n",
       "<tr class=\"repr-element channels-1270da44-edd8-440e-9b7b-0a86dd2740e8 \">\n",
       "    <td class=\"mne-repr-section-toggle\"></td>\n",
       "    <td>Head & sensor digitization</td>\n",
       "    \n",
       "    <td>257 points</td>\n",
       "    \n",
       "</tr>\n",
       "    \n",
       "\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "\n",
       "<tr class=\"mne-repr-section-header filters-1eabde95-83a7-4d7f-bdcf-847816356f22\"\n",
       "     title=\"Hide section\" \n",
       "    onclick=\"toggleVisibility('filters-1eabde95-83a7-4d7f-bdcf-847816356f22')\">\n",
       "    <th class=\"mne-repr-section-toggle\">\n",
       "        <button >\n",
       "            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d=\"M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z\"/></svg>\n",
       "        </button>\n",
       "    </th>\n",
       "    <th colspan=\"2\">\n",
       "        <strong>Filters</strong>\n",
       "    </th>\n",
       "</tr>\n",
       "\n",
       "\n",
       "<tr class=\"repr-element filters-1eabde95-83a7-4d7f-bdcf-847816356f22 \">\n",
       "    <td class=\"mne-repr-section-toggle\"></td>\n",
       "    <td>Highpass</td>\n",
       "    <td>0.10 Hz</td>\n",
       "</tr>\n",
       "\n",
       "\n",
       "<tr class=\"repr-element filters-1eabde95-83a7-4d7f-bdcf-847816356f22 \">\n",
       "    <td class=\"mne-repr-section-toggle\"></td>\n",
       "    <td>Lowpass</td>\n",
       "    <td>330.00 Hz</td>\n",
       "</tr>\n",
       "\n",
       "\n",
       "</table>"
      ],
      "text/plain": [
       "<Raw | CA112_MEEG_1_DurR3.fif, 405 x 791000 (791.0 s), ~2.39 GiB, data loaded>"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#filtragem \n",
    "raw.notch_filter(freqs=[50, 100, 150, 200, 250, 300], phase='zero', fir_design='firwin')  # rede elétrica"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bf075044-4dee-4b4a-95c7-7a0397670697",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Filtering raw data in 1 contiguous segment\n",
      "Setting up band-pass filter from 1 - 80 Hz\n",
      "\n",
      "FIR filter parameters\n",
      "---------------------\n",
      "Designing a one-pass, zero-phase, non-causal bandpass filter:\n",
      "- Windowed time-domain design (firwin) method\n",
      "- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation\n",
      "- Lower passband edge: 1.00\n",
      "- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)\n",
      "- Upper passband edge: 80.00 Hz\n",
      "- Upper transition bandwidth: 20.00 Hz (-6 dB cutoff frequency: 90.00 Hz)\n",
      "- Filter length: 3301 samples (3.301 s)\n",
      "\n",
      "Finding events on: STI101\n",
      "2042 events found on stim channel STI101\n",
      "Event IDs: [   1    2    3    4    5    6    7    8    9   10   11   12   13   15\n",
      "   16   17   18   19   20   21   22   23   24   25   26   27   28   29\n",
      "   30   31   32   33   34   35   36   37   38   39   40   41   42   43\n",
      "   44   45   46   47   48   49   50   51   52   53   54   55   56   57\n",
      "   58   59   60   61   62   63   64   65   66   67   68   69   70   71\n",
      "   72   73   74   76   77   78   79   80   96   97  101  102  103  111\n",
      "  112  113  114  115  116  117  118  119  120  121  122  123  124  125\n",
      "  126  127  128  129  130  131  132  133  134  135  136  137  138  139\n",
      "  140  141  142  143  144  145  146  147  151  152  153  177  178  179\n",
      "  180  181  182  183  184  201  202  203 5888 5984 6143]\n",
      "Finding events on: STI101\n",
      "2042 events found on stim channel STI101\n",
      "Event IDs: [   1    2    3    4    5    6    7    8    9   10   11   12   13   15\n",
      "   16   17   18   19   20   21   22   23   24   25   26   27   28   29\n",
      "   30   31   32   33   34   35   36   37   38   39   40   41   42   43\n",
      "   44   45   46   47   48   49   50   51   52   53   54   55   56   57\n",
      "   58   59   60   61   62   63   64   65   66   67   68   69   70   71\n",
      "   72   73   74   76   77   78   79   80   96   97  101  102  103  111\n",
      "  112  113  114  115  116  117  118  119  120  121  122  123  124  125\n",
      "  126  127  128  129  130  131  132  133  134  135  136  137  138  139\n",
      "  140  141  142  143  144  145  146  147  151  152  153  177  178  179\n",
      "  180  181  182  183  184  201  202  203 5888 5984 6143]\n",
      "<Raw | CA112_MEEG_1_DurR3.fif, 405 x 197750 (791.0 s), ~616.3 MiB, data loaded>\n",
      ">>> Fitting ICA (MEG)...\n"
     ]
    },
    {
     "ename": "ImportError",
     "evalue": "The sklearn package is required to use method='fastica', package was not found",
     "output_type": "error",
     "traceback": [
      "\u001b[31m---------------------------------------------------------------------------\u001b[39m",
      "\u001b[31mImportError\u001b[39m                               Traceback (most recent call last)",
      "\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[5]\u001b[39m\u001b[32m, line 15\u001b[39m\n\u001b[32m      8\u001b[39m ica_meg = ICA(\n\u001b[32m      9\u001b[39m     n_components=\u001b[32m0.99\u001b[39m,\n\u001b[32m     10\u001b[39m     method=\u001b[33m'\u001b[39m\u001b[33mfastica\u001b[39m\u001b[33m'\u001b[39m,      \u001b[38;5;66;03m# 'picard' se tiveres instalado\u001b[39;00m\n\u001b[32m     11\u001b[39m     random_state=\u001b[32m97\u001b[39m,\n\u001b[32m     12\u001b[39m     max_iter=\u001b[33m'\u001b[39m\u001b[33mauto\u001b[39m\u001b[33m'\u001b[39m,\n\u001b[32m     13\u001b[39m )\n\u001b[32m     14\u001b[39m \u001b[38;5;28mprint\u001b[39m(\u001b[33m\"\u001b[39m\u001b[33m>>> Fitting ICA (MEG)...\u001b[39m\u001b[33m\"\u001b[39m)\n\u001b[32m---> \u001b[39m\u001b[32m15\u001b[39m \u001b[43mica_meg\u001b[49m\u001b[43m.\u001b[49m\u001b[43mfit\u001b[49m\u001b[43m(\u001b[49m\u001b[43mraw_ica\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mpicks\u001b[49m\u001b[43m=\u001b[49m\u001b[33;43m'\u001b[39;49m\u001b[33;43mmeg\u001b[39;49m\u001b[33;43m'\u001b[39;49m\u001b[43m)\u001b[49m\n\u001b[32m     16\u001b[39m \u001b[38;5;66;03m# Detectar componentes EOG/ECG\u001b[39;00m\n\u001b[32m     17\u001b[39m eog_inds_meg, eog_scores_meg = ica_meg.find_bads_eog(\n\u001b[32m     18\u001b[39m     raw_ica,\n\u001b[32m     19\u001b[39m     ch_name=[\u001b[33m'\u001b[39m\u001b[33mEOG001\u001b[39m\u001b[33m'\u001b[39m, \u001b[33m'\u001b[39m\u001b[33mEOG002\u001b[39m\u001b[33m'\u001b[39m]\n\u001b[32m     20\u001b[39m )\n",
      "\u001b[36mFile \u001b[39m\u001b[32m<decorator-gen-395>:12\u001b[39m, in \u001b[36mfit\u001b[39m\u001b[34m(self, inst, picks, start, stop, decim, reject, flat, tstep, reject_by_annotation, verbose)\u001b[39m\n",
      "\u001b[36mFile \u001b[39m\u001b[32mc:\\Users\\tomas\\Desktop\\a pasta das aulas\\Mestrado\\The Last Year aka Tese\\A pasta do codigo organizado\\O codigo organizado\\blab-meeg\\.venv\\Lib\\site-packages\\mne\\preprocessing\\ica.py:671\u001b[39m, in \u001b[36mICA.fit\u001b[39m\u001b[34m(self, inst, picks, start, stop, decim, reject, flat, tstep, reject_by_annotation, verbose)\u001b[39m\n\u001b[32m    669\u001b[39m \u001b[38;5;28;01mfor\u001b[39;00m method, mod \u001b[38;5;129;01min\u001b[39;00m req_map.items():\n\u001b[32m    670\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m.method == method:\n\u001b[32m--> \u001b[39m\u001b[32m671\u001b[39m         \u001b[43m_require_version\u001b[49m\u001b[43m(\u001b[49m\u001b[43mmod\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[33;43mf\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43muse method=\u001b[39;49m\u001b[38;5;132;43;01m{\u001b[39;49;00m\u001b[38;5;28;43mrepr\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43mmethod\u001b[49m\u001b[43m)\u001b[49m\u001b[38;5;132;43;01m}\u001b[39;49;00m\u001b[33;43m\"\u001b[39;49m\u001b[43m)\u001b[49m\n\u001b[32m    673\u001b[39m _validate_type(inst, (BaseRaw, BaseEpochs), \u001b[33m\"\u001b[39m\u001b[33minst\u001b[39m\u001b[33m\"\u001b[39m, \u001b[33m\"\u001b[39m\u001b[33mRaw or Epochs\u001b[39m\u001b[33m\"\u001b[39m)\n\u001b[32m    675\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m np.isclose(inst.info[\u001b[33m\"\u001b[39m\u001b[33mhighpass\u001b[39m\u001b[33m\"\u001b[39m], \u001b[32m0.0\u001b[39m):\n",
      "\u001b[36mFile \u001b[39m\u001b[32mc:\\Users\\tomas\\Desktop\\a pasta das aulas\\Mestrado\\The Last Year aka Tese\\A pasta do codigo organizado\\O codigo organizado\\blab-meeg\\.venv\\Lib\\site-packages\\mne\\utils\\check.py:158\u001b[39m, in \u001b[36m_require_version\u001b[39m\u001b[34m(lib, what, version)\u001b[39m\n\u001b[32m    156\u001b[39m extra = \u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[33m (version >= \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mversion\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m)\u001b[39m\u001b[33m\"\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m version != \u001b[33m\"\u001b[39m\u001b[33m0.0\u001b[39m\u001b[33m\"\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m \u001b[33m\"\u001b[39m\u001b[33m\"\u001b[39m\n\u001b[32m    157\u001b[39m why = \u001b[33m\"\u001b[39m\u001b[33mpackage was not found\u001b[39m\u001b[33m\"\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m got \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;28;01melse\u001b[39;00m \u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[33mgot \u001b[39m\u001b[38;5;132;01m{\u001b[39;00m\u001b[38;5;28mrepr\u001b[39m(got)\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m\"\u001b[39m\n\u001b[32m--> \u001b[39m\u001b[32m158\u001b[39m \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mImportError\u001b[39;00m(\u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[33mThe \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mlib\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m package\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mextra\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m is required to \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mwhat\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m, \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mwhy\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m\"\u001b[39m)\n",
      "\u001b[31mImportError\u001b[39m: The sklearn package is required to use method='fastica', package was not found"
     ]
    }
   ],
   "source": [
    "# Caminho para treinar ICA: 1–80 Hz @ 250 Hz\n",
    "raw_ica = raw.copy()\n",
    "raw_ica.filter(1., 80., fir_design='firwin')\n",
    "raw_ica.resample(250.)\n",
    "print(raw_ica)\n",
    "# ICA para MEG\n",
    "ica_meg = ICA(\n",
    "    n_components=0.99,\n",
    "    method='fastica',      # 'picard' se tiveres instalado\n",
    "    random_state=97,\n",
    "    max_iter='auto',\n",
    ")\n",
    "print(\">>> Fitting ICA (MEG)...\")\n",
    "ica_meg.fit(raw_ica, picks='meg')\n",
    "# Detectar componentes EOG/ECG\n",
    "eog_inds_meg, eog_scores_meg = ica_meg.find_bads_eog(\n",
    "    raw_ica,\n",
    "    ch_name=['EOG001', 'EOG002']\n",
    ")\n",
    "ecg_inds_meg, ecg_scores_meg = ica_meg.find_bads_ecg(\n",
    "    raw_ica,\n",
    "    ch_name='ECG003'\n",
    ")\n",
    "ica_meg.exclude = sorted(set(eog_inds_meg + ecg_inds_meg))\n",
    "print(\"MEG ICs marcadas para exclusão:\", ica_meg.exclude)\n",
    "# Inspeção manual (OLHA MESMO PARA ISTO!)\n",
    "ica_meg.plot_sources(raw_ica, picks=ica_meg.exclude)\n",
    "ica_meg.plot_components(picks=ica_meg.exclude)\n",
    "plt.show()\n",
    "# Se vires que alguma componente não é EOG/ECG → tira dos exclude\n",
    "# Exemplo:\n",
    "# ica_meg.exclude = [0, 3, 7]\n",
    "# Aplicar ICA MEG ao sinal de análise (0.1–330)\n",
    "raw_meg_clean = ica_meg.apply(raw.copy())\n",
    "print(raw_meg_clean)\n",
    "\n",
    "\n",
    "# ICA para EEG\n",
    "ica_eeg = ICA(\n",
    "    n_components=0.99,\n",
    "    method='fastica',\n",
    "    random_state=97,\n",
    "    max_iter='auto',\n",
    ")\n",
    "print(\">>> Fitting ICA (EEG)...\")\n",
    "ica_eeg.fit(raw_ica, picks='eeg')\n",
    "# Detectar componentes EOG/ECG vistas no EEG\n",
    "eog_inds_eeg, eog_scores_eeg = ica_eeg.find_bads_eog(\n",
    "    raw_ica,\n",
    "    ch_name=['EOG001', 'EOG002']\n",
    ")\n",
    "ecg_inds_eeg, ecg_scores_eeg = ica_eeg.find_bads_ecg(\n",
    "    raw_ica,\n",
    "    ch_name='ECG003'\n",
    ")\n",
    "ica_eeg.exclude = sorted(set(eog_inds_eeg + ecg_inds_eeg))\n",
    "print(\"EEG ICs marcadas para exclusão:\", ica_eeg.exclude)\n",
    "# Inspeção manual só se houver ICs marcadas\n",
    "if len(ica_eeg.exclude) > 0:\n",
    "    ica_eeg.plot_sources(raw_ica, picks=ica_eeg.exclude)\n",
    "    ica_eeg.plot_components(picks=ica_eeg.exclude)\n",
    "    plt.show()\n",
    "else:\n",
    "    print(\"Nenhuma IC EEG foi automaticamente marcada como EOG/ECG.\")\n",
    "    # Se quiseres, podes inspecionar manualmente:\n",
    "    # ica_eeg.plot_components()  # sem picks, para veres todas\n",
    "# Ajusta se for preciso:\n",
    "# ica_eeg.exclude = [1, 5, 9]\n",
    "# Aplicar ICA EEG em cima do MEG-clean\n",
    "raw_clean = ica_eeg.apply(raw_meg_clean.copy())\n",
    "print(raw_clean)\n",
    "raw = raw_clean "
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "blab-meeg",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "name": "python",
   "version": "3.13.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
